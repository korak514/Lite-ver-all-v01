<UserControl x:Class="WPF_LoginForm.Views.SettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:viewModels="clr-namespace:WPF_LoginForm.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="650" d:DesignWidth="900">

    <UserControl.DataContext>
        <viewModels:SettingsViewModel/>
    </UserControl.DataContext>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Title -->
            <RowDefinition Height="*"/>
            <!-- Scrollable Content -->
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0" Text="Application Settings" 
                   Foreground="{StaticResource titleColor2}" 
                   FontSize="24" 
                   FontFamily="Montserrat" 
                   Margin="0,0,0,20"/>

        <!-- Scrollable Configuration Area -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="0,0,10,0">
            <StackPanel>

                <!-- 1. Active Provider Selection -->
                <Border CornerRadius="10" Padding="20" Margin="0,0,0,20"
                        BorderBrush="{StaticResource panelActiveColor}" BorderThickness="1">
                    <Border.Background>
                        <SolidColorBrush Color="{StaticResource primaryBackColor2}"/>
                    </Border.Background>
                    <StackPanel>
                        <TextBlock Text="Active Database Provider" Foreground="White" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10"/>
                        <TextBlock Text="Select which database system the application currently uses:" Foreground="{StaticResource titleColor3}" FontSize="12" Margin="0,0,0,10"/>

                        <ComboBox ItemsSource="{Binding DatabaseTypes}" 
                                  SelectedItem="{Binding SelectedDatabaseType, Mode=TwoWay}"
                                  HorizontalAlignment="Left" Width="200" Height="30" VerticalContentAlignment="Center" Padding="5"/>
                    </StackPanel>
                </Border>

                <!-- 2. SQL Server Settings -->
                <Border CornerRadius="10" Padding="20" Margin="0,0,0,20"
                        BorderBrush="{StaticResource panelActiveColor}" BorderThickness="1">
                    <Border.Background>
                        <SolidColorBrush Color="{StaticResource primaryBackColor2}"/>
                    </Border.Background>
                    <StackPanel>
                        <TextBlock Text="SQL Server Configuration" Foreground="{StaticResource color6}" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15"/>

                        <TextBlock Text="Auth Connection (LoginDb):" Foreground="{StaticResource titleColor3}" Margin="0,0,0,5"/>
                        <TextBox Text="{Binding SqlAuthString, UpdateSourceTrigger=PropertyChanged}" Padding="5" Height="30"/>

                        <TextBlock Text="Data Connection (Business Data):" Foreground="{StaticResource titleColor3}" Margin="0,10,0,5"/>
                        <TextBox Text="{Binding SqlDataString, UpdateSourceTrigger=PropertyChanged}" Padding="5" Height="30"/>
                    </StackPanel>
                </Border>

                <!-- 3. PostgreSQL Settings -->
                <Border CornerRadius="10" Padding="20" Margin="0,0,0,20"
                        BorderBrush="{StaticResource panelActiveColor}" BorderThickness="1">
                    <Border.Background>
                        <SolidColorBrush Color="{StaticResource primaryBackColor2}"/>
                    </Border.Background>
                    <StackPanel>
                        <TextBlock Text="PostgreSQL Configuration" Foreground="{StaticResource color8}" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15"/>

                        <TextBlock Text="Auth Connection (LoginDb):" Foreground="{StaticResource titleColor3}" Margin="0,0,0,5"/>
                        <TextBox Text="{Binding PostgresAuthString, UpdateSourceTrigger=PropertyChanged}" Padding="5" Height="30"/>

                        <TextBlock Text="Data Connection (Business Data):" Foreground="{StaticResource titleColor3}" Margin="0,10,0,5"/>
                        <TextBox Text="{Binding PostgresDataString, UpdateSourceTrigger=PropertyChanged}" Padding="5" Height="30"/>
                    </StackPanel>
                </Border>

                <!-- Action Buttons -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                    <Button Content="Save All Changes" 
                            Command="{Binding SaveCommand}"
                            Width="150" Height="40"
                            Background="{StaticResource panelColor}" Foreground="White" FontWeight="Bold"
                            Cursor="Hand" Margin="0,0,15,0">
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="5"/>
                            </Style>
                        </Button.Resources>
                    </Button>

                    <Button Content="Test Active Connection" 
                            Command="{Binding TestConnectionCommand}"
                            Width="180" Height="40"
                            Background="#444444" Foreground="White"
                            Cursor="Hand">
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="5"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                </StackPanel>

                <TextBlock Text="{Binding StatusMessage}" Foreground="{StaticResource color9}" FontSize="14" TextWrapping="Wrap"/>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>