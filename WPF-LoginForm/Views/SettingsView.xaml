<UserControl x:Class="WPF_LoginForm.Views.SettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:viewModels="clr-namespace:WPF_LoginForm.ViewModels"
             xmlns:p="clr-namespace:WPF_LoginForm.Properties"
             mc:Ignorable="d"
             d:DesignHeight="650" d:DesignWidth="900">

    <UserControl.DataContext>
        <viewModels:SettingsViewModel />
    </UserControl.DataContext>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Header: Application Settings -->
        <TextBlock Grid.Row="0" Text="{x:Static p:Resources.AppSettings}"
                   Foreground="{StaticResource titleColor2}"
                   FontSize="24"
                   FontFamily="Montserrat"
                   Margin="0,0,0,20" />

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="0,0,10,0">
            <StackPanel>

                <!-- 1. General Settings (Language) -->
                <Border CornerRadius="10" Padding="20" Margin="0,0,0,20"
                        BorderBrush="{StaticResource panelActiveColor}" BorderThickness="1">
                    <Border.Background>
                        <SolidColorBrush Color="{StaticResource primaryBackColor2}" />
                    </Border.Background>
                    <StackPanel>
                        <!-- Text: General Settings -->
                        <TextBlock Text="{x:Static p:Resources.GeneralSettings}" Foreground="White" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10" />

                        <!-- Text: Application Language -->
                        <TextBlock Text="{x:Static p:Resources.Language}" Foreground="{StaticResource titleColor3}" FontSize="12" Margin="0,0,0,5" />
                        <ComboBox ItemsSource="{Binding Languages}"
                                  DisplayMemberPath="Key"
                                  SelectedValuePath="Value"
                                  SelectedValue="{Binding SelectedLanguage, Mode=TwoWay}"
                                  HorizontalAlignment="Left" Width="200" Height="30" VerticalContentAlignment="Center" Padding="5" />
                        <TextBlock Text="* Restart required to apply changes." Foreground="Gray" FontSize="10" Margin="0,5,0,0" FontStyle="Italic" />
                    </StackPanel>
                </Border>

                <!-- 2. Active Provider Selection -->
                <Border CornerRadius="10" Padding="20" Margin="0,0,0,20"
                        BorderBrush="{StaticResource panelActiveColor}" BorderThickness="1">
                    <Border.Background>
                        <SolidColorBrush Color="{StaticResource primaryBackColor2}" />
                    </Border.Background>
                    <StackPanel>
                        <!-- Text: Database Provider -->
                        <TextBlock Text="{x:Static p:Resources.DbProvider}" Foreground="White" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10" />

                        <ComboBox ItemsSource="{Binding DatabaseTypes}"
                                  SelectedItem="{Binding SelectedDatabaseType, Mode=TwoWay}"
                                  HorizontalAlignment="Left" Width="200" Height="30" VerticalContentAlignment="Center" Padding="5" />
                    </StackPanel>
                </Border>

                <!-- 3. SQL Server Settings -->
                <Border CornerRadius="10" Padding="20" Margin="0,0,0,20"
                        BorderBrush="{StaticResource panelActiveColor}" BorderThickness="1">
                    <Border.Background>
                        <SolidColorBrush Color="{StaticResource primaryBackColor2}" />
                    </Border.Background>
                    <StackPanel>
                        <TextBlock Text="SQL Server Configuration" Foreground="{StaticResource color6}" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15" />

                        <TextBlock Text="Auth Connection (LoginDb):" Foreground="{StaticResource titleColor3}" Margin="0,0,0,5" />
                        <TextBox Text="{Binding SqlAuthString, UpdateSourceTrigger=PropertyChanged}" Padding="5" Height="30" />

                        <TextBlock Text="Data Connection (Business Data):" Foreground="{StaticResource titleColor3}" Margin="0,10,0,5" />
                        <TextBox Text="{Binding SqlDataString, UpdateSourceTrigger=PropertyChanged}" Padding="5" Height="30" />
                    </StackPanel>
                </Border>

                <!-- 4. PostgreSQL Settings -->
                <Border CornerRadius="10" Padding="20" Margin="0,0,0,20"
                        BorderBrush="{StaticResource panelActiveColor}" BorderThickness="1">
                    <Border.Background>
                        <SolidColorBrush Color="{StaticResource primaryBackColor2}" />
                    </Border.Background>
                    <StackPanel>
                        <TextBlock Text="PostgreSQL Configuration" Foreground="{StaticResource color8}" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15" />

                        <TextBlock Text="Auth Connection (LoginDb):" Foreground="{StaticResource titleColor3}" Margin="0,0,0,5" />
                        <TextBox Text="{Binding PostgresAuthString, UpdateSourceTrigger=PropertyChanged}" Padding="5" Height="30" />

                        <TextBlock Text="Data Connection (Business Data):" Foreground="{StaticResource titleColor3}" Margin="0,10,0,5" />
                        <TextBox Text="{Binding PostgresDataString, UpdateSourceTrigger=PropertyChanged}" Padding="5" Height="30" />
                    </StackPanel>
                </Border>

                <!-- Action Buttons -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                    <!-- Text: Save All Changes -->
                    <Button Content="{x:Static p:Resources.SaveSettings}"
                            Command="{Binding SaveCommand}"
                            Width="150" Height="40"
                            Background="{StaticResource panelColor}" Foreground="White" FontWeight="Bold"
                            Cursor="Hand" Margin="0,0,15,0">
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="5" />
                            </Style>
                        </Button.Resources>
                    </Button>

                    <!-- Text: Test Connection -->
                    <Button Content="{x:Static p:Resources.TestConnection}"
                            Command="{Binding TestConnectionCommand}"
                            Width="180" Height="40"
                            Background="#444444" Foreground="White"
                            Cursor="Hand">
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="5" />
                            </Style>
                        </Button.Resources>
                    </Button>
                </StackPanel>

                <TextBlock Text="{Binding StatusMessage}" Foreground="{StaticResource color9}" FontSize="14" TextWrapping="Wrap" />
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>